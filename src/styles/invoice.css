/**
 * Centralized Invoice Styling System
 *
 * This file contains all invoice-specific styles that ensure:
 * 1. Invoices are ALWAYS in light mode (dark mode never affects them)
 * 2. Consistent styling across preview, template selector, PDF, and print
 * 3. Template-specific styles remain untouched (templates use their own classes)
 *
 * Usage: Wrap invoice content with class "invoice-light-mode"
 */

/* ============================================================================
   BASE: Invoice Light Mode Isolation
   ============================================================================ */

/**
 * Core isolation class - creates a light mode context for invoices
 * This completely isolates invoices from dark mode using CSS isolation
 */
.invoice-light-mode {
  color-scheme: light !important;
  isolation: isolate;
  /* Creates a new stacking context */
  background-color: #ffffff !important;
}

/* ============================================================================
   DARK MODE OVERRIDES: Complete isolation from dark mode
   ============================================================================ */

@media (prefers-color-scheme: dark) {

  /* Force light mode container */
  .invoice-light-mode {
    color-scheme: light !important;
    background-color: #ffffff !important;
  }

  /**
   * AGGRESSIVE DARK MODE ISOLATION
   * Set default text color for ALL elements that don't have explicit inline styles
   * This ensures no element inherits dark mode colors
   * 
   * Note: We exclude elements with black backgrounds (they should have white text)
   * and elements that already have explicit color styles
   * 
   * IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color"
   */
  .invoice-light-mode *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]):not([style*="background: #000000"]):not([style*="background:#000000"]):not([style*="background-color: #000000"]):not([style*="background-color:#000000"]) {
    color: #1f2937 !important;
  }

  /**
   * CRITICAL: Preserve color inheritance for children of elements with explicit colors
   * This ensures templates can set colors on parents and children inherit correctly
   * This MUST come BEFORE black background rules so it can be overridden when needed
   * Higher specificity ensures this overrides the general dark color rule
   * 
   * IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color"
   */
  .invoice-light-mode [style*="color:"] *:not([style*="color:"]),
  .invoice-light-mode [style*="color:"] *:not([style*="color:"]) * {
    color: inherit !important;
  }

  /**
   * Handle dark backgrounds (not just black) - ensure children inherit parent colors
   * This fixes Typewriter template where parent has dark background + light text
   * Must come after color inheritance rule to work correctly
   * More specific selectors for elements with both dark background AND color
   * 
   * IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color"
   */
  .invoice-light-mode [style*="background: #3"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background: #4"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background: #5"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #3"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #4"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #5"] *:not([style*="color:"]),
  /* More specific: elements with dark background AND color - children should inherit */
  .invoice-light-mode [style*="background: #3"][style*="color:"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background: #4"][style*="color:"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background: #5"][style*="color:"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #3"][style*="color:"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #4"][style*="color:"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #5"][style*="color:"] *:not([style*="color:"]) {
    color: inherit !important;
  }

  /**
   * CRITICAL: Black background + white text (MUST come LAST to override everything)
   * This ensures elements with black backgrounds get white text, overriding ALL other rules
   * Higher specificity with multiple attribute selectors ensures this overrides inheritance rules
   */
  .invoice-light-mode [style*="background: #000"],
  .invoice-light-mode [style*="background:#000"],
  .invoice-light-mode [style*="background: #000000"],
  .invoice-light-mode [style*="background:#000000"],
  .invoice-light-mode [style*="background-color: #000"],
  .invoice-light-mode [style*="background-color:#000"],
  .invoice-light-mode [style*="background-color: #000000"],
  .invoice-light-mode [style*="background-color:#000000"],
  .invoice-light-mode [style*="background: rgb(0, 0, 0)"],
  .invoice-light-mode [style*="background:rgb(0, 0, 0)"] {
    color: #ffffff !important;
  }

  /* Also target all children of black background elements - MUST override everything including inheritance */
  /* Higher specificity: matches children of elements with black background, regardless of parent color */
  /* CRITICAL: Prevent dark text rule from applying to descendants of black backgrounds */
  /* IMPORTANT: Use "color:" (with colon) to specifically match the color property */
  .invoice-light-mode [style*="background: #000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background:#000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color:#000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background: #000000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background:#000000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color: #000000"] *:not([style*="color:"]),
  .invoice-light-mode [style*="background-color:#000000"] *:not([style*="color:"]) {
    color: #ffffff !important;
  }

  .invoice-light-mode [style*="background: #000"] *,
  .invoice-light-mode [style*="background:#000"] *,
  .invoice-light-mode [style*="background-color: #000"] *,
  .invoice-light-mode [style*="background-color:#000"] *,
  .invoice-light-mode [style*="background: #000000"] *,
  .invoice-light-mode [style*="background:#000000"] *,
  .invoice-light-mode [style*="background-color: #000000"] *,
  .invoice-light-mode [style*="background-color:#000000"] *,
  /* Even more specific: children of black background elements, even if parent has color */
  .invoice-light-mode [style*="background: #000"][style*="color:"] *,
  .invoice-light-mode [style*="background:#000"][style*="color:"] *,
  .invoice-light-mode [style*="background-color: #000"][style*="color:"] *,
  .invoice-light-mode [style*="background-color:#000"][style*="color:"] * {
    color: #ffffff !important;
  }

  /* Override Tailwind dark mode text classes - must come after general rule */
  .invoice-light-mode .dark\:text-white,
  .invoice-light-mode .dark\:text-slate-50,
  .invoice-light-mode .dark\:text-slate-100,
  .invoice-light-mode .dark\:text-slate-200,
  .invoice-light-mode .dark\:text-slate-300,
  .invoice-light-mode .dark\:text-slate-400 {
    color: #1f2937 !important;
  }

  /* Force light backgrounds - override dark mode background classes */
  .invoice-light-mode .dark\:bg-slate-800,
  .invoice-light-mode .dark\:bg-slate-700,
  .invoice-light-mode .dark\:bg-slate-900,
  .invoice-light-mode .dark\:bg-slate-950,
  .invoice-light-mode .dark\:bg-black {
    background-color: #ffffff !important;
  }

  /* Override border colors to light mode equivalents */
  .invoice-light-mode .dark\:border-slate-700,
  .invoice-light-mode .dark\:border-slate-600,
  .invoice-light-mode .dark\:border-slate-800 {
    border-color: #e5e7eb !important;
  }

  /* ========================================================================
     PDF GENERATION: Same aggressive isolation for PDF temp element
     ======================================================================== */

  .pdf-generation-temp {
    color-scheme: light !important;
    background-color: #ffffff !important;
  }

  /**
   * Set default text color for elements in PDF generation that don't have explicit colors
   * BUT: Preserve color inheritance for children of elements with explicit colors
   * 
   * Strategy: Apply dark color only to elements that:
   * 1. Don't have explicit color styles
   * 2. Are NOT inside elements with explicit colors (to preserve inheritance)
   * 3. Are NOT inside elements with black/dark backgrounds (those need special handling)
   * 
   * IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color"
   */
  .pdf-generation-temp *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]):not([style*="background: #000000"]):not([style*="background:#000000"]):not([style*="background-color: #000000"]):not([style*="background-color:#000000"]):not([style*="background: rgb(0"]):not([style*="background:rgb(0"]):not([style*="background-color: rgb(0"]):not([style*="background-color:rgb(0"]) {
    color: #1f2937 !important;
  }

  /**
   * CRITICAL FIX: Preserve color inheritance for children of elements with explicit colors
   * This ensures that when a template sets color on a parent (like Typewriter's TOTAL DUE),
   * children inherit that color instead of being overridden to dark
   * This MUST come BEFORE black background rules so inheritance works first
   * 
   * IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color"
   */
  .pdf-generation-temp [style*="color:"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="color:"] *:not([style*="color:"]) * {
    color: inherit !important;
  }

  /**
   * Handle dark backgrounds (not just black) - ensure children inherit parent colors
   * This fixes Typewriter template where parent has dark background + light text
   * Must come after color inheritance rule to work correctly
   * More specific selectors for elements with both dark background AND color
   * 
   * IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color"
   */
  .pdf-generation-temp [style*="background: #3"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background: #4"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background: #5"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #3"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #4"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #5"] *:not([style*="color:"]),
  /* More specific: elements with dark background AND color - children should inherit */
  .pdf-generation-temp [style*="background: #3"][style*="color:"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background: #4"][style*="color:"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background: #5"][style*="color:"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #3"][style*="color:"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #4"][style*="color:"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #5"][style*="color:"] *:not([style*="color:"]) {
    color: inherit !important;
  }

  /**
   * CRITICAL: Black background + white text (MUST come LAST to override everything)
   * This ensures elements with black backgrounds get white text, overriding ALL other rules
   * Higher specificity with multiple attribute selectors ensures this overrides inheritance rules
   */
  .pdf-generation-temp [style*="background: #000"],
  .pdf-generation-temp [style*="background:#000"],
  .pdf-generation-temp [style*="background: #000000"],
  .pdf-generation-temp [style*="background:#000000"],
  .pdf-generation-temp [style*="background-color: #000"],
  .pdf-generation-temp [style*="background-color:#000"],
  .pdf-generation-temp [style*="background-color: #000000"],
  .pdf-generation-temp [style*="background-color:#000000"],
  .pdf-generation-temp [style*="background: rgb(0, 0, 0)"],
  .pdf-generation-temp [style*="background:rgb(0, 0, 0)"] {
    color: #ffffff !important;
  }

  /* CRITICAL: Prevent dark text rule from applying to descendants of black backgrounds */
  /* IMPORTANT: Use "color:" (with colon) to specifically match the color property */
  .pdf-generation-temp [style*="background: #000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background:#000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color:#000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background: #000000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background:#000000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color: #000000"] *:not([style*="color:"]),
  .pdf-generation-temp [style*="background-color:#000000"] *:not([style*="color:"]) {
    color: #ffffff !important;
  }

  /* Also target all children of black background elements - MUST override everything including inheritance */
  .pdf-generation-temp [style*="background: #000"] *,
  .pdf-generation-temp [style*="background:#000"] *,
  .pdf-generation-temp [style*="background-color: #000"] *,
  .pdf-generation-temp [style*="background-color:#000"] *,
  .pdf-generation-temp [style*="background: #000000"] *,
  .pdf-generation-temp [style*="background:#000000"] *,
  .pdf-generation-temp [style*="background-color: #000000"] *,
  .pdf-generation-temp [style*="background-color:#000000"] *,
  /* Even more specific: children of black background elements, even if parent has color */
  /* IMPORTANT: Use "color:" (with colon) to specifically match the color property */
  .pdf-generation-temp [style*="background: #000"][style*="color:"] *,
  .pdf-generation-temp [style*="background:#000"][style*="color:"] *,
  .pdf-generation-temp [style*="background-color: #000"][style*="color:"] *,
  .pdf-generation-temp [style*="background-color:#000"][style*="color:"] * {
    color: #ffffff !important;
  }

  /* Override Tailwind dark mode classes in PDF */
  .pdf-generation-temp .dark\:text-white,
  .pdf-generation-temp .dark\:text-slate-50,
  .pdf-generation-temp .dark\:text-slate-100,
  .pdf-generation-temp .dark\:text-slate-200,
  .pdf-generation-temp .dark\:text-slate-300,
  .pdf-generation-temp .dark\:text-slate-400 {
    color: #1f2937 !important;
  }

  .pdf-generation-temp .dark\:bg-slate-800,
  .pdf-generation-temp .dark\:bg-slate-700,
  .pdf-generation-temp .dark\:bg-slate-900 {
    background-color: #ffffff !important;
  }
}

/* ============================================================================
   PRINT STYLES: Ensure invoices print correctly
   ============================================================================ */

@media print {
  @page {
    margin: 0;
    size: A4;
  }

  /* Force light mode for all print content */
  * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-scheme: light !important;
  }

  html,
  body {
    margin: 0 !important;
    padding: 0 !important;
    width: 100% !important;
    height: 100vh !important;
    overflow: hidden !important;
    color-scheme: light !important;
  }

  /**
   * CRITICAL: Print mode dark mode isolation
   * Print mode doesn't respect prefers-color-scheme, so we need to override
   * ALL dark mode styles directly in print media query
   */

  /* Override ALL Tailwind dark mode classes in print - they should never apply */
  .dark\:text-white,
  .dark\:text-slate-50,
  .dark\:text-slate-100,
  .dark\:text-slate-200,
  .dark\:text-slate-300,
  .dark\:text-slate-400,
  .dark\:text-slate-500,
  .dark\:text-slate-600,
  .dark\:text-slate-700,
  .dark\:text-slate-800,
  .dark\:text-slate-900 {
    color: #1f2937 !important;
  }

  .dark\:bg-slate-800,
  .dark\:bg-slate-700,
  .dark\:bg-slate-900,
  .dark\:bg-slate-950,
  .dark\:bg-black {
    background-color: #ffffff !important;
  }

  /* Hide everything by default */
  body * {
    visibility: hidden;
  }

  /* Show only invoice print container and its invoice content */
  .invoice-print-container,
  .invoice-print-container .invoice-content-print,
  .invoice-print-container .invoice-content-print * {
    visibility: visible !important;
    color-scheme: light !important;
  }

  .invoice-print-container {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    margin: 0 !important;
    padding: 0 !important;
    background: white !important;
    z-index: 99999 !important;
    color-scheme: light !important;
  }

  /* Remove modal styling */
  .invoice-print-container>div {
    position: static !important;
    background: white !important;
    box-shadow: none !important;
    border-radius: 0 !important;
    max-width: 100% !important;
    width: 100% !important;
    height: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    overflow: visible !important;
    color-scheme: light !important;
  }

  /* Hide header and footer */
  .invoice-print-container>div>div:first-child,
  .invoice-print-container>div>div:last-child {
    display: none !important;
    visibility: hidden !important;
  }

  /* Position and size invoice content */
  .invoice-content-print {
    position: fixed !important;
    top: 0 !important;
    left: 50% !important;
    transform: translateX(-50%) !important;
    width: 210mm !important;
    height: auto !important;
    min-height: 297mm !important;
    margin: 0 !important;
    padding: 10mm !important;
    border: 0 !important;
    box-sizing: border-box !important;
    overflow: visible !important;
    background: white !important;
    page-break-after: avoid !important;
    page-break-inside: avoid !important;
    color-scheme: light !important;
    /* Force print color adjustment to preserve colors */
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    /* Don't force color here - let children inherit or use their own styles */
  }

  /* Scale the invoice content to fit - ensure all content is visible */
  .invoice-content-print>div {
    width: 100% !important;
    max-width: 100% !important;
    height: auto !important;
    transform-origin: top center !important;
    page-break-after: avoid !important;
    page-break-inside: avoid !important;
    overflow: visible !important;
    color-scheme: light !important;
  }

  /**
   * PRINT MODE: Complete dark mode isolation
   * Override ALL dark mode styles - print should ALWAYS be light mode
   * This applies regardless of system dark mode preference
   */

  /* CRITICAL: Force light mode on invoice content container */
  .invoice-content-print,
  .invoice-content-print * {
    color-scheme: light !important;
  }

  /* Override Tailwind dark mode classes in print - MUST come first */
  .invoice-content-print .dark\:text-white,
  .invoice-content-print .dark\:text-slate-50,
  .invoice-content-print .dark\:text-slate-100,
  .invoice-content-print .dark\:text-slate-200,
  .invoice-content-print .dark\:text-slate-300,
  .invoice-content-print .dark\:text-slate-400,
  .invoice-content-print .dark\:text-slate-500,
  .invoice-content-print .dark\:text-slate-600,
  .invoice-content-print .dark\:text-slate-700,
  .invoice-content-print .dark\:text-slate-800,
  .invoice-content-print .dark\:text-slate-900 {
    color: #1f2937 !important;
  }

  .invoice-content-print .dark\:bg-slate-800,
  .invoice-content-print .dark\:bg-slate-700,
  .invoice-content-print .dark\:bg-slate-900,
  .invoice-content-print .dark\:bg-slate-950,
  .invoice-content-print .dark\:bg-black {
    background-color: #ffffff !important;
  }

  /**
   * PRINT MODE: Preserve original template colors
   * We should NOT override inline styles - templates already have correct colors
   * Only override Tailwind dark mode classes and ensure print-color-adjust
   */

  /* Only override Tailwind dark mode classes - don't touch inline styles */
  /* Templates use inline styles which should be preserved */

  /* Handle dark backgrounds in print mode - more specific selectors */
  /* BUT exclude black backgrounds - they're handled separately below */
  /* IMPORTANT: Use "color:" (with colon) to specifically match the color property,
   * not "color" which would incorrectly match "background-color" */
  .invoice-content-print [style*="background: #3"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background: #4"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background: #5"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background-color: #3"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background-color: #4"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background-color: #5"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  /* More specific: elements with dark background AND color - children should inherit */
  .invoice-content-print [style*="background: #3"][style*="color:"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background: #4"][style*="color:"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background: #5"][style*="color:"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background-color: #3"][style*="color:"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background-color: #4"][style*="color:"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]),
  .invoice-content-print [style*="background-color: #5"][style*="color:"] *:not([style*="color:"]):not([style*="background: #000"]):not([style*="background:#000"]):not([style*="background-color: #000"]):not([style*="background-color:#000"]) {
    color: inherit !important;
  }

  /* Override Tailwind dark mode classes - templates use inline styles which are preserved */
  /* Only override Tailwind classes, not inline styles */
  .invoice-content-print .dark\:text-white,
  .invoice-content-print .dark\:text-slate-50,
  .invoice-content-print .dark\:text-slate-100,
  .invoice-content-print .dark\:text-slate-200,
  .invoice-content-print .dark\:text-slate-300,
  .invoice-content-print .dark\:text-slate-400,
  .invoice-content-print .dark\:text-slate-500,
  .invoice-content-print .dark\:text-slate-600,
  .invoice-content-print .dark\:text-slate-700,
  .invoice-content-print .dark\:text-slate-800,
  .invoice-content-print .dark\:text-slate-900 {
    color: #1f2937 !important;
  }

  /* Ensure PDF generation temp element is not affected by print CSS */
  .pdf-generation-temp,
  .pdf-generation-temp * {
    visibility: hidden !important;
  }

  .print\:hidden {
    display: none !important;
    visibility: hidden !important;
  }

  .print\:border-0 {
    border: 0 !important;
  }
}

/* ============================================================================
   TEMPLATE THUMBNAIL STYLES: For template selector previews
   ============================================================================ */

/**
 * General styles for all templates in thumbnail view
 * Uses attribute selectors to target any template class pattern
 * This works for all current and future templates without modification
 */

/* Target any element with a class ending in "-template" inside thumbnail wrapper */
.template-thumbnail-wrapper [class*="-template"] {
  padding: 40px !important;
  max-width: 800px !important;
  width: 800px !important;
}

/* Target any element with a class ending in "-header" inside thumbnail wrapper */
.template-thumbnail-wrapper [class*="-header"] {
  flex-direction: row !important;
}

/* Target any element with a class containing "grid" or "info-grid" */
.template-thumbnail-wrapper [class*="grid"],
.template-thumbnail-wrapper [class*="info-grid"],
.template-thumbnail-wrapper [class*="client-dates"],
.template-thumbnail-wrapper [class*="payment-notes"] {
  grid-template-columns: 1fr 1fr !important;
}

/* Target any element with a class containing "details" or "totals" */
.template-thumbnail-wrapper [class*="details"],
.template-thumbnail-wrapper [class*="totals"] {
  flex-direction: row !important;
}

/* Target any element with a class containing "company" or "profile" */
.template-thumbnail-wrapper [class*="company"],
.template-thumbnail-wrapper [class*="profile"] {
  margin-top: 0 !important;
}

/* Target any table inside thumbnail wrapper - ensure desktop layout */
/* CRITICAL: Override ALL responsive styles from template media queries */
.template-thumbnail-wrapper table {
  display: table !important;
  table-layout: fixed !important;
  width: 100% !important;
  border-collapse: collapse !important;
  font-size: inherit !important;
}

.template-thumbnail-wrapper table thead {
  display: table-header-group !important;
}

.template-thumbnail-wrapper table tbody {
  display: table-row-group !important;
}

.template-thumbnail-wrapper table thead tr,
.template-thumbnail-wrapper table tbody tr,
.template-thumbnail-wrapper table tr {
  display: table-row !important;
  width: 100% !important;
}

.template-thumbnail-wrapper table th,
.template-thumbnail-wrapper table td {
  display: table-cell !important;
}

/* Prevent vertical character stacking in scaled previews - force horizontal text */
.template-thumbnail-wrapper * {
  writing-mode: horizontal-tb !important;
  text-orientation: mixed !important;
  direction: ltr !important;
  -webkit-font-smoothing: antialiased !important;
  -moz-osx-font-smoothing: grayscale !important;
  text-rendering: optimizeLegibility !important;
}

/* CRITICAL: Override responsive table styles from template media queries */
/* Force desktop table layout regardless of viewport size */
.template-thumbnail-wrapper table[class*="-table"],
.template-thumbnail-wrapper .brutalist-table,
.template-thumbnail-wrapper .classic-table,
.template-thumbnail-wrapper .modern-table,
.template-thumbnail-wrapper .typewriter-table,
.template-thumbnail-wrapper .swiss-table,
.template-thumbnail-wrapper .professional-table,
.template-thumbnail-wrapper .minimal-japanese-table,
.template-thumbnail-wrapper .dark-mode-table,
.template-thumbnail-wrapper .neo-brutalist-table {
  display: table !important;
  table-layout: fixed !important;
  width: 100% !important;
  font-size: inherit !important;
}

.template-thumbnail-wrapper table[class*="-table"] thead,
.template-thumbnail-wrapper .brutalist-table thead,
.template-thumbnail-wrapper .classic-table thead,
.template-thumbnail-wrapper .modern-table thead,
.template-thumbnail-wrapper .typewriter-table thead,
.template-thumbnail-wrapper .swiss-table thead,
.template-thumbnail-wrapper .professional-table thead,
.template-thumbnail-wrapper .minimal-japanese-table thead,
.template-thumbnail-wrapper .dark-mode-table thead,
.template-thumbnail-wrapper .neo-brutalist-table thead {
  display: table-header-group !important;
}

.template-thumbnail-wrapper table[class*="-table"] tbody,
.template-thumbnail-wrapper .brutalist-table tbody,
.template-thumbnail-wrapper .classic-table tbody,
.template-thumbnail-wrapper .modern-table tbody,
.template-thumbnail-wrapper .typewriter-table tbody,
.template-thumbnail-wrapper .swiss-table tbody,
.template-thumbnail-wrapper .professional-table tbody,
.template-thumbnail-wrapper .minimal-japanese-table tbody,
.template-thumbnail-wrapper .dark-mode-table tbody,
.template-thumbnail-wrapper .neo-brutalist-table tbody {
  display: table-row-group !important;
}

.template-thumbnail-wrapper table[class*="-table"] tr,
.template-thumbnail-wrapper .brutalist-table tr,
.template-thumbnail-wrapper .classic-table tr,
.template-thumbnail-wrapper .modern-table tr,
.template-thumbnail-wrapper .typewriter-table tr,
.template-thumbnail-wrapper .swiss-table tr,
.template-thumbnail-wrapper .professional-table tr,
.template-thumbnail-wrapper .minimal-japanese-table tr,
.template-thumbnail-wrapper .dark-mode-table tr,
.template-thumbnail-wrapper .neo-brutalist-table tr {
  display: table-row !important;
  width: 100% !important;
}

.template-thumbnail-wrapper table[class*="-table"] th,
.template-thumbnail-wrapper table[class*="-table"] td,
.template-thumbnail-wrapper .brutalist-table th,
.template-thumbnail-wrapper .brutalist-table td,
.template-thumbnail-wrapper .classic-table th,
.template-thumbnail-wrapper .classic-table td,
.template-thumbnail-wrapper .modern-table th,
.template-thumbnail-wrapper .modern-table td,
.template-thumbnail-wrapper .typewriter-table th,
.template-thumbnail-wrapper .typewriter-table td,
.template-thumbnail-wrapper .swiss-table th,
.template-thumbnail-wrapper .swiss-table td,
.template-thumbnail-wrapper .professional-table th,
.template-thumbnail-wrapper .professional-table td,
.template-thumbnail-wrapper .minimal-japanese-table th,
.template-thumbnail-wrapper .minimal-japanese-table td,
.template-thumbnail-wrapper .dark-mode-table th,
.template-thumbnail-wrapper .dark-mode-table td,
.template-thumbnail-wrapper .neo-brutalist-table th,
.template-thumbnail-wrapper .neo-brutalist-table td {
  display: table-cell !important;
  padding: inherit !important;
  font-size: inherit !important;
}

/* CRITICAL: Force thead to respect column widths - prevent it from stretching full width */
.template-thumbnail-wrapper table thead {
  display: table-header-group !important;
  width: 100% !important;
}

.template-thumbnail-wrapper table thead tr {
  display: table-row !important;
  width: 100% !important;
}

/* CRITICAL: Set column widths on the first row (thead) to ensure table-layout: fixed works correctly */
/* With table-layout: fixed, column widths are determined by the first row */
/* These MUST be set on thead th to establish the column structure */
/* Use highly specific selectors to override template inline styles */
.template-thumbnail-wrapper table thead th:first-child,
.template-thumbnail-wrapper .brutalist-table thead th:first-child,
.template-thumbnail-wrapper .classic-table thead th:first-child,
.template-thumbnail-wrapper .modern-table thead th:first-child,
.template-thumbnail-wrapper .typewriter-table thead th:first-child,
.template-thumbnail-wrapper .swiss-table thead th:first-child,
.template-thumbnail-wrapper .professional-table thead th:first-child,
.template-thumbnail-wrapper .minimal-japanese-table thead th:first-child,
.template-thumbnail-wrapper .dark-mode-table thead th:first-child,
.template-thumbnail-wrapper .neo-brutalist-table thead th:first-child {
  width: 50% !important;
  min-width: 0 !important;
  max-width: 50% !important;
}

.template-thumbnail-wrapper table thead th:nth-child(2),
.template-thumbnail-wrapper .brutalist-table thead th:nth-child(2),
.template-thumbnail-wrapper .classic-table thead th:nth-child(2),
.template-thumbnail-wrapper .modern-table thead th:nth-child(2),
.template-thumbnail-wrapper .typewriter-table thead th:nth-child(2),
.template-thumbnail-wrapper .swiss-table thead th:nth-child(2),
.template-thumbnail-wrapper .professional-table thead th:nth-child(2),
.template-thumbnail-wrapper .minimal-japanese-table thead th:nth-child(2),
.template-thumbnail-wrapper .dark-mode-table thead th:nth-child(2),
.template-thumbnail-wrapper .neo-brutalist-table thead th:nth-child(2) {
  width: 15% !important;
  min-width: 0 !important;
  max-width: 15% !important;
}

.template-thumbnail-wrapper table thead th:nth-child(3),
.template-thumbnail-wrapper .brutalist-table thead th:nth-child(3),
.template-thumbnail-wrapper .classic-table thead th:nth-child(3),
.template-thumbnail-wrapper .modern-table thead th:nth-child(3),
.template-thumbnail-wrapper .typewriter-table thead th:nth-child(3),
.template-thumbnail-wrapper .swiss-table thead th:nth-child(3),
.template-thumbnail-wrapper .professional-table thead th:nth-child(3),
.template-thumbnail-wrapper .minimal-japanese-table thead th:nth-child(3),
.template-thumbnail-wrapper .dark-mode-table thead th:nth-child(3),
.template-thumbnail-wrapper .neo-brutalist-table thead th:nth-child(3) {
  width: 20% !important;
  min-width: 0 !important;
  max-width: 20% !important;
}

.template-thumbnail-wrapper table thead th:nth-child(4),
.template-thumbnail-wrapper .brutalist-table thead th:nth-child(4),
.template-thumbnail-wrapper .classic-table thead th:nth-child(4),
.template-thumbnail-wrapper .modern-table thead th:nth-child(4),
.template-thumbnail-wrapper .typewriter-table thead th:nth-child(4),
.template-thumbnail-wrapper .swiss-table thead th:nth-child(4),
.template-thumbnail-wrapper .professional-table thead th:nth-child(4),
.template-thumbnail-wrapper .minimal-japanese-table thead th:nth-child(4),
.template-thumbnail-wrapper .dark-mode-table thead th:nth-child(4),
.template-thumbnail-wrapper .neo-brutalist-table thead th:nth-child(4) {
  width: 15% !important;
  min-width: 0 !important;
  max-width: 15% !important;
}

/* Ensure description cells wrap properly in thumbnail preview */
/* Apply width to BOTH th and td for first column to ensure alignment */
/* Use specific selectors to override template responsive styles */
.template-thumbnail-wrapper table th:first-child,
.template-thumbnail-wrapper table td:first-child,
.template-thumbnail-wrapper .brutalist-table th:first-child,
.template-thumbnail-wrapper .brutalist-table td:first-child,
.template-thumbnail-wrapper .classic-table th:first-child,
.template-thumbnail-wrapper .classic-table td:first-child,
.template-thumbnail-wrapper .modern-table th:first-child,
.template-thumbnail-wrapper .modern-table td:first-child,
.template-thumbnail-wrapper .typewriter-table th:first-child,
.template-thumbnail-wrapper .typewriter-table td:first-child,
.template-thumbnail-wrapper .swiss-table th:first-child,
.template-thumbnail-wrapper .swiss-table td:first-child,
.template-thumbnail-wrapper .professional-table th:first-child,
.template-thumbnail-wrapper .professional-table td:first-child,
.template-thumbnail-wrapper .minimal-japanese-table th:first-child,
.template-thumbnail-wrapper .minimal-japanese-table td:first-child,
.template-thumbnail-wrapper .dark-mode-table th:first-child,
.template-thumbnail-wrapper .dark-mode-table td:first-child,
.template-thumbnail-wrapper .neo-brutalist-table th:first-child,
.template-thumbnail-wrapper .neo-brutalist-table td:first-child {
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  white-space: normal !important;
  display: table-cell !important;
  vertical-align: top !important;
  writing-mode: horizontal-tb !important;
  text-orientation: mixed !important;
  /* Fixed width percentage to prevent character-by-character breaking */
  width: 50% !important;
  min-width: 0 !important;
  max-width: 50% !important;
  padding: 8px 12px !important;
  box-sizing: border-box !important;
}

/* Set widths for other columns to maintain table structure */
/* Ensure both headers and cells have matching widths */
.template-thumbnail-wrapper table th:nth-child(2),
.template-thumbnail-wrapper table td:nth-child(2),
.template-thumbnail-wrapper .brutalist-table th:nth-child(2),
.template-thumbnail-wrapper .brutalist-table td:nth-child(2),
.template-thumbnail-wrapper .classic-table th:nth-child(2),
.template-thumbnail-wrapper .classic-table td:nth-child(2),
.template-thumbnail-wrapper .modern-table th:nth-child(2),
.template-thumbnail-wrapper .modern-table td:nth-child(2),
.template-thumbnail-wrapper .typewriter-table th:nth-child(2),
.template-thumbnail-wrapper .typewriter-table td:nth-child(2),
.template-thumbnail-wrapper .swiss-table th:nth-child(2),
.template-thumbnail-wrapper .swiss-table td:nth-child(2),
.template-thumbnail-wrapper .professional-table th:nth-child(2),
.template-thumbnail-wrapper .professional-table td:nth-child(2),
.template-thumbnail-wrapper .minimal-japanese-table th:nth-child(2),
.template-thumbnail-wrapper .minimal-japanese-table td:nth-child(2),
.template-thumbnail-wrapper .dark-mode-table th:nth-child(2),
.template-thumbnail-wrapper .dark-mode-table td:nth-child(2),
.template-thumbnail-wrapper .neo-brutalist-table th:nth-child(2),
.template-thumbnail-wrapper .neo-brutalist-table td:nth-child(2) {
  width: 15% !important;
  min-width: 0 !important;
  max-width: 15% !important;
  padding: 8px 12px !important;
  box-sizing: border-box !important;
}

.template-thumbnail-wrapper table th:nth-child(3),
.template-thumbnail-wrapper table td:nth-child(3),
.template-thumbnail-wrapper .brutalist-table th:nth-child(3),
.template-thumbnail-wrapper .brutalist-table td:nth-child(3),
.template-thumbnail-wrapper .classic-table th:nth-child(3),
.template-thumbnail-wrapper .classic-table td:nth-child(3),
.template-thumbnail-wrapper .modern-table th:nth-child(3),
.template-thumbnail-wrapper .modern-table td:nth-child(3),
.template-thumbnail-wrapper .typewriter-table th:nth-child(3),
.template-thumbnail-wrapper .typewriter-table td:nth-child(3),
.template-thumbnail-wrapper .swiss-table th:nth-child(3),
.template-thumbnail-wrapper .swiss-table td:nth-child(3),
.template-thumbnail-wrapper .professional-table th:nth-child(3),
.template-thumbnail-wrapper .professional-table td:nth-child(3),
.template-thumbnail-wrapper .minimal-japanese-table th:nth-child(3),
.template-thumbnail-wrapper .minimal-japanese-table td:nth-child(3),
.template-thumbnail-wrapper .dark-mode-table th:nth-child(3),
.template-thumbnail-wrapper .dark-mode-table td:nth-child(3),
.template-thumbnail-wrapper .neo-brutalist-table th:nth-child(3),
.template-thumbnail-wrapper .neo-brutalist-table td:nth-child(3) {
  width: 20% !important;
  min-width: 0 !important;
  max-width: 20% !important;
  padding: 8px 12px !important;
  box-sizing: border-box !important;
}

.template-thumbnail-wrapper table th:nth-child(4),
.template-thumbnail-wrapper table td:nth-child(4),
.template-thumbnail-wrapper .brutalist-table th:nth-child(4),
.template-thumbnail-wrapper .brutalist-table td:nth-child(4),
.template-thumbnail-wrapper .classic-table th:nth-child(4),
.template-thumbnail-wrapper .classic-table td:nth-child(4),
.template-thumbnail-wrapper .modern-table th:nth-child(4),
.template-thumbnail-wrapper .modern-table td:nth-child(4),
.template-thumbnail-wrapper .typewriter-table th:nth-child(4),
.template-thumbnail-wrapper .typewriter-table td:nth-child(4),
.template-thumbnail-wrapper .swiss-table th:nth-child(4),
.template-thumbnail-wrapper .swiss-table td:nth-child(4),
.template-thumbnail-wrapper .professional-table th:nth-child(4),
.template-thumbnail-wrapper .professional-table td:nth-child(4),
.template-thumbnail-wrapper .minimal-japanese-table th:nth-child(4),
.template-thumbnail-wrapper .minimal-japanese-table td:nth-child(4),
.template-thumbnail-wrapper .dark-mode-table th:nth-child(4),
.template-thumbnail-wrapper .dark-mode-table td:nth-child(4),
.template-thumbnail-wrapper .neo-brutalist-table th:nth-child(4),
.template-thumbnail-wrapper .neo-brutalist-table td:nth-child(4) {
  width: 15% !important;
  min-width: 0 !important;
  max-width: 15% !important;
  padding: 8px 12px !important;
  box-sizing: border-box !important;
}

/* Prevent vertical character stacking in scaled previews */
.template-thumbnail-wrapper table td,
.template-thumbnail-wrapper table th {
  white-space: normal !important;
  word-break: break-word !important;
  display: table-cell !important;
  vertical-align: top !important;
  writing-mode: horizontal-tb !important;
  text-orientation: mixed !important;
  overflow: hidden !important;
  box-sizing: border-box !important;
  /* Prevent responsive styles from making cells full width */
  max-width: none !important;
}

/* CRITICAL: Prevent any responsive styles from overriding column structure */
/* Override any width: 100% rules that might come from responsive media queries */
.template-thumbnail-wrapper table th:not(:first-child):not(:nth-child(2)):not(:nth-child(3)):not(:nth-child(4)),
.template-thumbnail-wrapper table td:not(:first-child):not(:nth-child(2)):not(:nth-child(3)):not(:nth-child(4)) {
  width: auto !important;
}

/* For templates using div-based layouts (like ColorPopGridTemplate) */
.template-thumbnail-wrapper [style*="grid-template-columns"]>div:first-child,
.template-thumbnail-wrapper [style*="display: grid"]>div:first-child {
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  white-space: normal !important;
}

/* Professional template totals table - prevent squashing in thumbnail preview */
.template-thumbnail-wrapper .professional-totals-table-container {
  width: auto !important;
  min-width: 200px !important;
  max-width: none !important;
}

.template-thumbnail-wrapper .professional-totals-table-container table {
  min-width: 200px !important;
  width: auto !important;
  table-layout: auto !important;
}

.template-thumbnail-wrapper .professional-currency-value {
  white-space: nowrap !important;
  min-width: 100px !important;
}

/* Classic template - prevent squashing of line item descriptions in thumbnail */
/* Override media query styles that reduce padding/font-size when viewport < 768px */
.template-thumbnail-wrapper .classic-table {
  table-layout: fixed !important;
  width: 100% !important;
  font-size: inherit !important;
}

.template-thumbnail-wrapper .classic-table th,
.template-thumbnail-wrapper .classic-table td {
  padding: 12px !important;
  font-size: inherit !important;
}

.template-thumbnail-wrapper .classic-table th:first-child,
.template-thumbnail-wrapper .classic-table td:first-child {
  width: 50% !important;
  min-width: 200px !important;
  word-wrap: break-word !important;
  overflow-wrap: break-word !important;
  white-space: normal !important;
}

.template-thumbnail-wrapper .classic-info-section {
  flex-direction: row !important;
  gap: 20px !important;
}

.template-thumbnail-wrapper .classic-info-section>div:first-child {
  max-width: 300px !important;
  min-width: 200px !important;
}

/* PDF-specific adjustments - general template adjustments */
.pdf-generation-temp [class*="-invoice-number"] {
  margin-top: 20px !important;
}